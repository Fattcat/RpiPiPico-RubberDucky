import textwrap

# HID kódy pre slovenský QWERTY layout s podporou diakritiky
ALTGR = 0x40  # Pravý Alt (AltGr)
SHIFT = 0x02  # Shift
SK_HID_MAP = {
    'a': (0x00, 0x04), 'A': (0x02, 0x04),
    'á': (0x02, 0x1A), 'Á': (0x20, 0x1A),
    'ä': (0x02, 0x34), 'Ä': (0x20, 0x34),
    'b': (0x00, 0x05), 'B': (0x02, 0x05),
    'c': (0x00, 0x06), 'C': (0x02, 0x06),
    'č': (0x02, 0x1C), 'Č': (0x20, 0x1C),
    'd': (0x00, 0x07), 'D': (0x02, 0x07),
    'ď': (0x02, 0x1D), 'Ď': (0x20, 0x1D),
    'e': (0x00, 0x08), 'E': (0x02, 0x08),
    'é': (0x02, 0x18), 'É': (0x20, 0x18),
    'f': (0x00, 0x09), 'F': (0x02, 0x09),
    'g': (0x00, 0x0A), 'G': (0x02, 0x0A),
    'h': (0x00, 0x0B), 'H': (0x02, 0x0B),
    'i': (0x00, 0x0C), 'I': (0x02, 0x0C),
    'í': (0x02, 0x19), 'Í': (0x20, 0x19),
    'j': (0x00, 0x0D), 'J': (0x02, 0x0D),
    'k': (0x00, 0x0E), 'K': (0x02, 0x0E),
    'l': (0x00, 0x0F), 'L': (0x02, 0x0F),
    'ľ': (0x02, 0x1F), 'Ľ': (0x20, 0x1F),
    'ĺ': (0x02, 0x24), 'Ĺ': (0x20, 0x24),
    'm': (0x00, 0x10), 'M': (0x02, 0x10),
    'n': (0x00, 0x11), 'N': (0x02, 0x11),
    'ň': (0x02, 0x25), 'Ň': (0x20, 0x25),
    'o': (0x00, 0x12), 'O': (0x02, 0x12),
    'ó': (0x02, 0x26), 'Ó': (0x20, 0x26),
    'ô': (0x02, 0x27), 'Ô': (0x20, 0x27),
    'p': (0x00, 0x13), 'P': (0x02, 0x13),
    'q': (0x00, 0x14), 'Q': (0x02, 0x14),
    'r': (0x00, 0x15), 'R': (0x02, 0x15),
    's': (0x00, 0x16), 'S': (0x02, 0x16),
    'š': (0x02, 0x28), 'Š': (0x20, 0x28),
    't': (0x00, 0x17), 'T': (0x02, 0x17),
    'ť': (0x02, 0x29), 'Ť': (0x20, 0x29),
    'u': (0x00, 0x18), 'U': (0x02, 0x18),
    'ú': (0x02, 0x2A), 'Ú': (0x20, 0x2A),
    'v': (0x00, 0x19), 'V': (0x02, 0x19),
    'w': (0x00, 0x1A), 'W': (0x02, 0x1A),
    'x': (0x00, 0x1B), 'X': (0x02, 0x1B),
    'y': (0x00, 0x1C), 'Y': (0x02, 0x1C),
    'z': (0x00, 0x1D), 'Z': (0x02, 0x1D),
    'ž': (0x02, 0x2C), 'Ž': (0x20, 0x2C),
    '0': (0x00, 0x27), '1': (0x00, 0x1E), '2': (0x00, 0x1F),
    '3': (0x00, 0x20), '4': (0x00, 0x21), '5': (0x00, 0x22),
    '6': (0x00, 0x23), '7': (0x00, 0x24), '8': (0x00, 0x25),
    '9': (0x00, 0x26),
    ' ': (0x00, 0x2C), '\n': (0x00, 0x28),
    '?': (0x02, 0x38), '!': (0x02, 0x1E), '_': (0x02, 0x2D),
    '"': (0x02, 0x34), ':': (0x02, 0x33), ')': (0x02, 0x27),
    '(': (0x02, 0x26), '-': (0x00, 0x2D), '.': (0x00, 0x37),
    ',': (0x00, 0x36), '*': (0x02, 0x25), '<': (0x02, 0x64),
    '>': (0x02, 0x64), '#': (0x02, 0x20), '&': (0x02, 0x24),
    '@': (0x02, 0x1F), '$': (0x02, 0x21),
    '[': (0x00, 0x2F), ']': (0x00, 0x30),
    '{': (0x02, 0x2F), '}': (0x02, 0x30),
    '|': (0x02, 0x31), '\\': (0x00, 0x31),

    'ˇ': (0x2D, ALTGR),  # AltGr + '-'
    '%': (0x02, 0x22),
    '/': (0x00, 0x38),
    '§': (0x40, 0x16),  # AltGr + s

    '´': (ALTGR, 0x2D),  # AltGr + - (mŕtvy znak pre akútny prízvuk, napr. ´a)
    '=': (SHIFT, 0x30),  # Shift + 0 (na slovenskej QWERTY klávesnici)
    '+': (SHIFT, 0x2E),  # Shift + = → na SK layoute je to spolu: '+' cez Shift+ú
    '€': (ALTGR, 0x08),  # AltGr + E (HID kód pre 'e' je 0x08)
    'ý': (ALTGR, 0x1C),  # AltGr + Y → na SK layout nie je natívne, workaround
    'Ý': (ALTGR | SHIFT, 0x1C),  # teoretická veľká verzia
}

text = input("Zadaj text na konverziu do HID kódov (SK layout):\n")
hid_data = []

for char in text:
    if char in SK_HID_MAP:
        mod, key = SK_HID_MAP[char]
        hid_data.extend([mod, key])
    else:
        print(f"Warning: znak '{char}' nie je v mape, nahradzujem medzerou")
        hid_data.extend([0x00, 0x2C])  # nahradiť medzerou

# Vytvorenie výstupu
output = ', '.join(f'0x{b:02X}' for b in hid_data)
lines = textwrap.wrap(output, 64)

print("\n// Vygenerované HID pole pre SK layout")
print(f"// Pôvodný text: {text}")
print("const uint8_t key_arr[] PROGMEM = {")
for line in lines:
    print(f"  {line},")
print("};")
